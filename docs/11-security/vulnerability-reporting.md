# Vulnerability Reporting

How to report security vulnerabilities in Eligify.

## Overview

We take security seriously. If you discover a security vulnerability in Eligify, please report it responsibly to help us keep the package and our users safe.

## Reporting Process

### 1. Do Not Publicly Disclose

**Please do not publicly disclose the vulnerability** until we've had a chance to address it. This includes:

- Do not open public GitHub issues
- Do not post in forums or social media
- Do not discuss on public chat channels

### 2. Contact Security Team

**Email:** <security@cleaniquecoders.com>

Include the following information in your report:

- **Description**: Clear description of the vulnerability
- **Impact**: What can an attacker achieve?
- **Steps to Reproduce**: Detailed steps to reproduce the issue
- **Proof of Concept**: Code or commands demonstrating the vulnerability
- **Affected Versions**: Which versions are affected?
- **Suggested Fix**: If you have a solution, please share it

### 3. Example Report Template

```markdown
**Vulnerability Type:** [e.g., SQL Injection, XSS, Code Injection]

**Severity:** [Critical/High/Medium/Low]

**Description:**
A SQL injection vulnerability exists in the criteria evaluation endpoint
that allows attackers to execute arbitrary SQL queries.

**Steps to Reproduce:**
1. Create a malicious criteria with the following payload
2. Send POST request to /api/eligify/evaluate
3. Observe database query execution

**Proof of Concept:**
POST /api/eligify/evaluate
Content-Type: application/json

{
  "criteria": "test'; DROP TABLE users; --",
  "entity_id": 1,
  "entity_type": "App\\Models\\User"
}

**Impact:**
Attackers can:
- Read sensitive data from database
- Modify or delete records
- Escalate privileges

**Affected Versions:**
- 1.0.0 - 1.2.5

**Suggested Fix:**
Use parameterized queries instead of string concatenation.

**Your Contact Information:**
Name: John Doe
Email: john@example.com
```

## Response Timeline

### What to Expect

- **Initial Response**: Within 48 hours
- **Status Update**: Within 7 days
- **Fix Timeline**: Depends on severity
  - **Critical**: 1-7 days
  - **High**: 7-14 days
  - **Medium**: 14-30 days
  - **Low**: 30-90 days

### Communication

We will:

1. Acknowledge receipt of your report
2. Confirm the vulnerability
3. Provide a timeline for the fix
4. Keep you updated on progress
5. Credit you in the security advisory (if desired)

## Severity Levels

### Critical

- Remote code execution
- SQL injection allowing data exfiltration
- Authentication bypass
- Privilege escalation to admin

### High

- XSS allowing account takeover
- CSRF on sensitive actions
- Information disclosure of sensitive data
- Insecure default configuration

### Medium

- XSS on non-sensitive pages
- Denial of service (DoS)
- Path traversal
- Missing security headers

### Low

- Information disclosure (non-sensitive)
- Rate limiting issues
- Logging sensitive data
- Missing input validation (no exploit path)

## Bug Bounty

Currently, we do not have a formal bug bounty program. However:

- We recognize and credit researchers in security advisories
- We provide acknowledgment in release notes
- We may offer rewards on a case-by-case basis for critical vulnerabilities

## Security Best Practices

### For Developers

If you're developing with Eligify, follow these security practices:

1. **Keep Package Updated**

   ```bash
   composer update cleaniquecoders/eligify
   ```

2. **Enable Security Features**

   ```php
   // config/eligify.php
   'security' => [
       'audit' => true,
       'rate_limiting' => true,
       'input_sanitization' => true,
   ],
   ```

3. **Use Authorization**

   ```php
   $this->authorize('evaluate-eligibility');
   ```

4. **Validate Inputs**

   ```php
   $request->validate([
       'criteria' => 'required|string|max:255',
       'entity_id' => 'required|integer',
   ]);
   ```

5. **Monitor Logs**

   ```bash
   tail -f storage/logs/laravel.log | grep -i eligify
   ```

## Known Vulnerabilities

### Security Advisories

We publish security advisories for confirmed vulnerabilities:

- [GitHub Security Advisories](https://github.com/cleaniquecoders/eligify/security/advisories)
- [CHANGELOG.md](../../CHANGELOG.md) - Security fixes are marked with `[SECURITY]`

### How to Check

```bash
# Check for known vulnerabilities
composer audit

# Update to latest secure version
composer update cleaniquecoders/eligify --with-dependencies
```

## Hall of Fame

We recognize security researchers who responsibly disclose vulnerabilities:

<!-- This section will be updated with researcher names -->

- *No vulnerabilities have been reported yet*

## Scope

### In Scope

Vulnerabilities in:

- Core Eligify package code
- Eligify UI components
- API endpoints
- Data handling and storage
- Authentication and authorization
- Input validation

### Out of Scope

- Vulnerabilities in dependencies (report to respective maintainers)
- Social engineering attacks
- Physical attacks
- DoS attacks requiring significant resources
- Issues in example code or documentation
- Already reported vulnerabilities

## Security Updates

### Notification Channels

Stay informed about security updates:

- **GitHub Watch**: Watch the repository for security advisories
- **Composer**: Run `composer audit` regularly
- **Newsletter**: Subscribe at cleaniquecoders.com/eligify
- **Twitter**: Follow @CleaniqueCoder for security announcements

### Version Support

| Version | Supported          |
|---------|--------------------|
| 1.x     | ✅ Security fixes  |
| < 1.0   | ❌ No longer supported |

## Disclosure Policy

### Coordinated Disclosure

We follow responsible disclosure principles:

1. Security issue is reported privately
2. We investigate and develop a fix
3. We release a security patch
4. We publish a security advisory
5. Reporter is credited (if desired)

### Timeline

- **90 days**: Standard disclosure timeline
- **Shorter**: For actively exploited vulnerabilities
- **Longer**: By mutual agreement for complex issues

## Contact

### Security Team

- **Email**: <security@cleaniquecoders.com>
- **PGP Key**: Available on request
- **Response Time**: Within 48 hours

### Alternative Contacts

If you don't receive a response within 48 hours:

- **GitHub**: @nasrulhazim
- **Twitter**: @CleaniqueCoder

## Legal

### Safe Harbor

We will not pursue legal action against researchers who:

- Follow this disclosure policy
- Act in good faith
- Don't harm users or data
- Don't demand payment or rewards

### No Retaliation

We commit to:

- Not take legal action against good faith security research
- Work with researchers to fix vulnerabilities
- Credit researchers publicly (with permission)

## Additional Resources

- [OWASP Top 10](https://owasp.org/www-project-top-ten/)
- [Laravel Security](https://laravel.com/docs/security)
- [PHP Security Guide](https://www.php.net/manual/en/security.php)
- [Composer Security](https://getcomposer.org/doc/articles/scripts.md#security)

## Thank You

Thank you for helping keep Eligify and our users safe. Responsible disclosure helps everyone, and we appreciate your efforts to improve security.

## Related Documentation

- [Security Best Practices](best-practices.md)
- [Authorization](authorization.md)
- [Input Validation](input-validation.md)
